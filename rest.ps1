
$users = Import-Csv -Path D:\file.csv
$token = "eyJ0eXAiOiJKV1QiLCJub25jZSI6ImpKbkhVa3dwTlFvWHFlbzZqUEw3aklyOXp4OWdqSnFGeDJ1cEpxRUNsM2MiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9lOTlmNjlkMi01OTQ2LTRiNDctOWNkMy00NzA2YTRhMDExODQvIiwiaWF0IjoxNjI2MjMxNjE5LCJuYmYiOjE2MjYyMzE2MTksImV4cCI6MTYyNjIzNTUxOSwiYWNjdCI6MCwiYWNyIjoiMSIsImFjcnMiOlsidXJuOnVzZXI6cmVnaXN0ZXJzZWN1cml0eWluZm8iLCJ1cm46bWljcm9zb2Z0OnJlcTEiLCJ1cm46bWljcm9zb2Z0OnJlcTIiLCJ1cm46bWljcm9zb2Z0OnJlcTMiLCJjMSIsImMyIiwiYzMiLCJjNCIsImM1IiwiYzYiLCJjNyIsImM4IiwiYzkiLCJjMTAiLCJjMTEiLCJjMTIiLCJjMTMiLCJjMTQiLCJjMTUiLCJjMTYiLCJjMTciLCJjMTgiLCJjMTkiLCJjMjAiLCJjMjEiLCJjMjIiLCJjMjMiLCJjMjQiLCJjMjUiXSwiYWlvIjoiQVNRQTIvOFRBQUFBVnc1UE1UMmcvMkZ3NUpINjF0dFl0TmxQbEFMYmNUdjlZbnQybFpmUnJ1OD0iLCJhbXIiOlsicHdkIl0sImFwcF9kaXNwbGF5bmFtZSI6IkdyYXBoIGV4cGxvcmVyIChvZmZpY2lhbCBzaXRlKSIsImFwcGlkIjoiZGU4YmM4YjUtZDlmOS00OGIxLWE4YWQtYjc0OGRhNzI1MDY0IiwiYXBwaWRhY3IiOiIwIiwiZmFtaWx5X25hbWUiOiJCaGFyZHdhaiIsImdpdmVuX25hbWUiOiJBbmt1ciIsImlkdHlwIjoidXNlciIsImlwYWRkciI6IjE2Ny4yMjAuMjU1LjM2IiwibmFtZSI6IkFua3VyIEJoYXJkd2FqIiwib2lkIjoiYzNiYzk2OGItZTRiZC00ZTJiLTlhOGItMDg5NTNlZGRhODU4IiwicGxhdGYiOiIzIiwicHVpZCI6IjEwMDMyMDAxNTRBNzVDRkQiLCJyaCI6IjAuQVc0QTBtbWY2VVpaUjB1YzAwY0dwS0FSaExYSWk5NzUyYkZJcUsyM1NOcHlVR1J1QUFrLiIsInNjcCI6Im9wZW5pZCBwcm9maWxlIFVzZXIuUmVhZCBVc2VyQXV0aGVudGljYXRpb25NZXRob2QuUmVhZCBVc2VyQXV0aGVudGljYXRpb25NZXRob2QuUmVhZC5BbGwgVXNlckF1dGhlbnRpY2F0aW9uTWV0aG9kLlJlYWRXcml0ZSBVc2VyQXV0aGVudGljYXRpb25NZXRob2QuUmVhZFdyaXRlLkFsbCBlbWFpbCIsInNpZ25pbl9zdGF0ZSI6WyJrbXNpIl0sInN1YiI6IjREVEZqbWlsYVI5dG9ZWDdjZVlKSXNLMV9iOE43RU9QSzVLM0FpS0VnUWMiLCJ0ZW5hbnRfcmVnaW9uX3Njb3BlIjoiTkEiLCJ0aWQiOiJlOTlmNjlkMi01OTQ2LTRiNDctOWNkMy00NzA2YTRhMDExODQiLCJ1bmlxdWVfbmFtZSI6ImFua3VyLmJoYXJkd2FqQE0zNjV4Mzk5MTI0Lm9ubWljcm9zb2Z0LmNvbSIsInVwbiI6ImFua3VyLmJoYXJkd2FqQE0zNjV4Mzk5MTI0Lm9ubWljcm9zb2Z0LmNvbSIsInV0aSI6Il9ZRlUzdkd1cEVtWWFCQjNZUjlLQUEiLCJ2ZXIiOiIxLjAiLCJ3aWRzIjpbIjYyZTkwMzk0LTY5ZjUtNDIzNy05MTkwLTAxMjE3NzE0NWUxMCIsImI3OWZiZjRkLTNlZjktNDY4OS04MTQzLTc2YjE5NGU4NTUwOSJdLCJ4bXNfc3QiOnsic3ViIjoiR1VJeFdPZFE1a3ZIQkhKRmNLZGJKbGNQMG9aUzY5V2ktYUQ0UXJESk5QQSJ9LCJ4bXNfdGNkdCI6MTU5OTA4MjI4NX0.k5dThZp4XOAbcRXh1Hq2qhW05ZFgMUG5gPWqiLcV4CIfhA1h16nxtc6m6Qui7lgICO8vv6EKKNiar05lz9WlwBKAgmOFjQTq5jA-6F4GwXPxHf0o3OBO7Ko-rpr1OPDEocW3CDnqKYeL9UdDa7iLGa_9DnFFT4DmdEM971Kw9cEci46eNKitTf0Gxoiw7Cy2ZWGXPdFKLOZPbFWI2IVEq48xOp7Ahs2xjEPzgVAs-yz9OFSGtZdtw7P2LIJcMT18haVqAxP7To8irylgtts3pZmXdovOBhscePSvpiqb-0UxzTct8Qv5VD97p4tyDsIQqZKQ8uZi2LZ1h2lmAkIGGA"

Write-Warning "Proceeding to delete phone numbers, Please wait patiently!"
Write-Host "Processing....." -f Green
Foreach ($u in $users) {
    $restOutput = Invoke-RestMethod -Uri "https://graph.microsoft.com/beta/users/$($u.userprincipalName)/authentication/phoneMethods" -Method Get -Headers @{"Authorization"="Bearer $token"}
    Write-Host "User: $($u.userprincipalName) ==>> $($restOutput.value.phonenumber)" -f Yellow
    $Id = $restOutput.value.id
    Invoke-RestMethod -Uri "https://graph.microsoft.com/beta/users/$($u.userprincipalName)/authentication/phonemethods/$Id" -Method Delete -Headers @{"Authorization"="Bearer $token"}
    Write-Host "Delete successful!"
    Write-Host "------------------------------" -f White 
}
